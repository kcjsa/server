<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>Minecraftサーバー申請フォーム</title>
</head>
<body>
<h1>申請フォーム</h1>
<form id="form">
  <input name="name" placeholder="名前" required /><br />
  <input name="email" type="email" placeholder="メール" required /><br />
  <textarea name="purpose" placeholder="利用目的" required></textarea><br />
  <button type="submit">送信</button>
</form>
<p id="msg"></p>

<script>
  const form = document.getElementById('form');
  const msg = document.getElementById('msg');

  form.addEventListener('submit', async e => {
    e.preventDefault();
    if (localStorage.getItem('applied')) {
      msg.textContent = 'すでに申請済みです。';
      return;
    }
    const data = Object.fromEntries(new FormData(form).entries());

    try {
      const res = await fetch('https://your-cloudflare-worker-url.workers.dev', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data),
      });
      if (res.ok) {
        msg.textContent = '申請完了しました。管理者に通知されます。';
        localStorage.setItem('applied', 'true');
        form.reset();
      } else {
        msg.textContent = '送信に失敗しました。';
      }
    } catch {
      msg.textContent = '送信に失敗しました。';
    }
  });
</script>
</body>
</html>
